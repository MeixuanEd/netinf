function pertValues = PertCorrs(data, pertIdx, pertTimes, pad, thresh)
    [nvars, timeLength] = size(data);
    numPerts = length(pertTimes);
    
    pertValues = zeros(numPerts, nvars);
    for k=1:numPerts
        pertInd = pertIdx(k);
        
        leftBound = max(pertTimes(k) - pad, 1);
        rightBound = min(pertTimes(k) + pad, timeLength);
        pertWindow = leftBound:rightBound;
        windowData = data(:, pertWindow);
        
        corrMat = abs(corr(windowData.'));
        corrs = corrMat(pertInd, :);
        values = 1 ./ corrs;
        values(corrs < thresh) = Inf;
        pertValues(k, :) = round(values, 4);
    end
end
