source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/generate_data.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/generate_data.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/generate_data.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/2_nodes.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
source('~/rEDM/ccm_causal_inference/ccm_scripts/ccm_sines.R')
nncoupled_model <- nncoupled_data(n, time, pinpfn, zerovfn,
pinmfn, constkfn, bc=bc)
# position function that places nodes 2 and 4 at equilibrium
pinpfn <- function(n, bc) {
return(c(runif(1, -0.25, 0.25), 0.25, runif(1, 0.25, 0.75), 0.75))
}
# mass function that makes masses of nodes 2 and 4 very large
pinmfn <- function(n) {
return(c(1, 10000, 1, 10000))
}
nncoupled_model <- nncoupled_data(n, time, pinpfn, zerovfn,
pinmfn, constkfn, bc=bc)
# position function that places nodes 2 and 4 at equilibrium
pinpfn <- function(n, bc) {
return(c(runif(1, -0.25, 0.25), 0.25, runif(1, 0.25, 0.75), 0.75))
}
# mass function that makes masses of nodes 2 and 4 very large
pinmfn <- function(n) {
return(c(1, 10000, 1, 10000))
}
trials <- 100
libs <- seq(10, tmax-10, by = 10)
noise <- 0.05
nncoupled_model <- nncoupled_data(n, time, pinpfn, zerovfn,
pinmfn, constkfn, bc=bc)
source('~/rEDM/ccm_causal_inference/ccm_scripts/4_nodes_blocked.R', echo=TRUE)
nncoupled_model <- nncoupled_data(n, time, pinpfn, zerovfn,
pinmfn, constkfn, bc=bc)
nncoupled_model
plot(nncoupled_model["pos1"])
plot(nncoupled_model[,"pos1"])
plot(nncoupled_model[,"pos1"], type="l")
plot(nncoupled_model[,"pos1"], type="l")
nncoupled_model <- nncoupled_data(n, time, pinpfn, zerovfn,
pinmfn, constkfn, bc=bc)
plot(nncoupled_model[,"pos1"], type="l")
plot(nncoupled_model[,"pos3"], type="l")
nncoupled_model <- nncoupled_data(n, time, pinpfn, zerovfn,
pinmfn, constkfn, bc=bc)
plot(nncoupled_model[,"pos1"], type="l")
plot(nncoupled_model[,"pos3"], type="l")
plot(fft(nncoupled_model[,"pos1"]) / (N/2);)
plot(fft(nncoupled_model[,"pos1"]) / (N/2))
plot(fft(nncoupled_model[,"pos1"]) / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos1"])) / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos3"])) / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos1"])) / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos2"])) / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos4"])) / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos4"]))[1:tmax/2] / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos4"])) / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos4"]))[1] / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos4"]))[1:tmax/2] / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos4"]))[1:2] / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos4"]))[1:10] / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos4"]))[1:(tmax/2)] / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos1"]))[1:(tmax/2)] / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos1"]))[1:(tmax/3)] / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos1"]))[1:(tmax/2)] / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos3"]))[1:(tmax/2)] / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos1"]))[1:(tmax/2)] / (tmax/2))
plot(abs(fft(nncoupled_model[,"pos3"]))[1:4] / (tmax/2))
plot(nncoupled_model[,"pos3"])
plot(nncoupled_model[,"pos3"], type="l")
plot(nncoupled_model[,"pos1"], type="l")
plot(nncoupled_model[,"pos1"], type="l")
nncoupled_model[,"pos1"] == nncoupled_model[,"pos3"]
matequal(nncoupled_model[,"pos1"], nncoupled_model[,"pos3"])
all(nncoupled_model[,"pos1"] == nncoupled_model[,"pos3"])
nncoupled_model[,"pos1"]
nncoupled_model[,"pos3"]
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/generate_data.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
data.frame(time, s1=rep(0.5, length(time)), s2=sin(time))
df <- data.frame(time, s1=rep(0.5, length(time)), s2=sin(time))
a_xmap_b <- ccm(df, E = E, lib_column = "s1",
target_column = "s2", lib_sizes = libs,
num_samples = 100, random_libs = TRUE, replace = TRUE);
b_xmap_a <- ccm(df, E = E, lib_column = "s2",
target_column = "s1", lib_sizes = libs,
num_samples = 100, random_libs = TRUE, replace = TRUE);
a_xmap_b_rho
a_xmap_b_rho <- 0
b_xmap_a_rho <- 0
a_xmap_b_means <- ccm_means(a_xmap_b);
b_xmap_a_means <- ccm_means(b_xmap_a);
a_xmap_b_rho <- a_xmap_b_rho + a_xmap_b_means$rho
b_xmap_a_rho <- b_xmap_a_rho + b_xmap_a_means$rho
par(mar = c(4, 4, 1, 1), mgp = c(2.5, 1, 0))
ab <- pmax(0, a_xmap_b_rho);
ba <- pmax(0, b_xmap_a_rho);
plot(a_xmap_b_means$lib_size, ab, type = "l", col = "red", xlab = "Library Size",
ylab = "Cross Map Skill (rho)", ylim = c(0, 1), main = "a = 1, b = 3")
lines(b_xmap_a_means$lib_size, ba, col = "blue")
legend(x = "topleft", legend = c("s1 xmap s2", "s2 xmap s1"),
col = c("red", "blue"), lwd = 1, bty = "n", inset = 0.02, cex = 0.8)
ab
ba
matplot(df)
df <- data.frame(time, s1=rep(0.5, length(time)), s2=sin(10*time))
matplot(df)
a_xmap_b_rho <- 0
b_xmap_a_rho <- 0
a_xmap_b <- ccm(df, E = E, lib_column = "s1",
target_column = "s2", lib_sizes = libs,
num_samples = 100, random_libs = TRUE, replace = TRUE);
b_xmap_a <- ccm(df, E = E, lib_column = "s2",
target_column = "s1", lib_sizes = libs,
num_samples = 100, random_libs = TRUE, replace = TRUE);
a_xmap_b_means <- ccm_means(a_xmap_b);
b_xmap_a_means <- ccm_means(b_xmap_a);
a_xmap_b_rho <- a_xmap_b_rho + a_xmap_b_means$rho
b_xmap_a_rho <- b_xmap_a_rho + b_xmap_a_means$rho
par(mar = c(4, 4, 1, 1), mgp = c(2.5, 1, 0))
ab <- pmax(0, a_xmap_b_rho);
ba <- pmax(0, b_xmap_a_rho);
plot(a_xmap_b_means$lib_size, ab, type = "l", col = "red", xlab = "Library Size",
ylab = "Cross Map Skill (rho)", ylim = c(0, 1), main = "a = 1, b = 3")
lines(b_xmap_a_means$lib_size, ba, col = "blue")
legend(x = "topleft", legend = c("s1 xmap s2", "s2 xmap s1"),
col = c("red", "blue"), lwd = 1, bty = "n", inset = 0.02, cex = 0.8)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
adj
adj_comp
max_rho
which(adj[3, 1,] > 0.95 * max_rho[i, j])[1]
which(adj[3, 1,] > 0.95 * max_rho[3, 1])[1]
adj[3, 1,]
max_rho[3, 1]
matplot(nncoupled_model[, !(colnames(nncoupled_model) %in% "time")], type="l")
nncoupled_model <- nncoupled_data(n, time, randpfn, zerovfn,
constmfn, constkfn, zerocfn, bc=bc, pert=0)
matplot(nncoupled_model[, !(colnames(nncoupled_model) %in% "time")], type="l")
xmap <- ccm(data[[t]], E = E, lib_column = names[i],
target_column = names[j], lib_sizes = lib_sizes,
num_samples = num_samples, random_libs = TRUE, replace = TRUE);
xmap_means <- ccm_means(xmap)
plot(xmap_means$lib_size, pmax(0, xmap_means$rho), type = "l", col = "red", xlab = "Library Size",
ylab = "Cross Map Skill (rho)", ylim = c(0, 1), main = paste(i, j))
xmap <- ccm(nncoupled_model, E = E, lib_column = names[i],
target_column = names[j], lib_sizes = lib_sizes,
num_samples = num_samples, random_libs = TRUE, replace = TRUE);
xmap_means <- ccm_means(xmap)
plot(xmap_means$lib_size, pmax(0, xmap_means$rho), type = "l", col = "red", xlab = "Library Size",
ylab = "Cross Map Skill (rho)", ylim = c(0, 1), main = paste(i, j))
xmap <- ccm(nncoupled_model, E = E, lib_column = names[i],
target_column = names[j], lib_sizes = libs,
num_samples = num_samples, random_libs = TRUE, replace = TRUE);
xmap_means <- ccm_means(xmap)
plot(xmap_means$lib_size, pmax(0, xmap_means$rho), type = "l", col = "red", xlab = "Library Size",
ylab = "Cross Map Skill (rho)", ylim = c(0, 1), main = paste(i, j))
xmap <- ccm(nncoupled_model, E = E, lib_column = names[i],
target_column = names[j], lib_sizes = libs,
num_samples = num_samples, random_libs = TRUE, replace = TRUE);
xmap_means <- ccm_means(xmap)
plot(xmap_means$lib_size, pmax(0, xmap_means$rho), type = "l", col = "red", xlab = "Library Size",
ylab = "Cross Map Skill (rho)", ylim = c(0, 1), main = paste(i, j))
xmap <- ccm(nncoupled_model, E = E, lib_column = names[i],
target_column = names[j], lib_sizes = libs,
num_samples = num_samples, random_libs = TRUE, replace = TRUE);
xmap <- ccm(nncoupled_model, E = E, lib_column = names[i],
target_column = names[j], lib_sizes = libs,
num_samples = 100, random_libs = TRUE, replace = TRUE);
xmap_means <- ccm_means(xmap)
plot(xmap_means$lib_size, pmax(0, xmap_means$rho), type = "l", col = "red", xlab = "Library Size",
ylab = "Cross Map Skill (rho)", ylim = c(0, 1), main = paste(i, j))
xmap <- ccm(nncoupled_model, E = E, lib_column = names[1],
target_column = names[2], lib_sizes = libs,
num_samples = 100, random_libs = TRUE, replace = TRUE);
xmap_means <- ccm_means(xmap)
plot(xmap_means$lib_size, pmax(0, xmap_means$rho), type = "l", col = "red", xlab = "Library Size",
ylab = "Cross Map Skill (rho)", ylim = c(0, 1), main = paste(i, j))
xmap_means <- ccm_means(xmap)
plot(xmap_means$lib_size, pmax(0, xmap_means$rho), type = "l", col = "red", xlab = "Library Size",
ylab = "Cross Map Skill (rho)", ylim = c(0, 1), main = paste(1, 2))
xmap <- ccm(nncoupled_model, E = E, lib_column = names[2],
target_column = names[1], lib_sizes = libs,
num_samples = 100, random_libs = TRUE, replace = TRUE);
xmap
xmap <- ccm(nncoupled_model, E = E, lib_column = names[1],
target_column = names[2], lib_sizes = libs,
num_samples = 100, random_libs = TRUE, replace = TRUE);
xmap_means <- ccm_means(xmap)
plot(xmap_means$lib_size, pmax(0, xmap_means$rho), type = "l", col = "red", xlab = "Library Size",
ylab = "Cross Map Skill (rho)", ylim = c(0, 1), main = paste(1, 2))
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
data
data[[1]]
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
adj
adj_opt_rho
t(adj_opt_rho)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/generate_data.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_helper.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
source('~/rEDM/ccm_causal_inference/ccm_scripts/mass_increase.R', echo=TRUE)
get_ccm_rho
library(rEDM)
update.packages(ask = FALSE)
library(rEDM)
install.packages("rEDM", "/home/user/anaconda3/lib/R/library")
install.packages("rEDM", "/home/user/anaconda3/lib/R/library")
install.packages("rEDM", "~/anaconda2/lib/R/library")
install.packages("rEDM", "~/anaconda2/envs/renv/lib/R/library")
install.packages("rEDM", "~/anaconda2/envs/renv/lib/R/library")
